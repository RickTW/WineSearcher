<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ricerca Google Sheet</title>
</head>
<body>
  <input type="text" id="query" placeholder="Inserisci stringa">
  <button onclick="cerca()">Cerca</button>
  <div id="risultato"></div>
  <script>
    function cerca() {
      var q = document.getElementById('query').value;
      fetch('https://script.google.com/macros/s/AKfycbyULB1rn-3bd0N4etNAcLVeCqJwYXY455QWeraArSWTxsVyQKL66x-JvWHNnjQk-eAi/exec?q=' + encodeURIComponent(q))
        .then(r => r.json())
        .then(arr => {
          if (typeof arr === "string" || arr.length === 0) {
            document.getElementById('risultato').innerText = arr;
            return;
          }
          // Intestazioni delle colonne (puoi personalizzare i nomi)
          let html = "<table border='1'><tr>" +
            "<th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>L</th><th>S</th><th>U</th><th>X</th></tr>";
          arr.forEach(row => {
            html += "<tr>" + row.map(cell => `<td>${cell}</td>`).join('') + "</tr>";
          });
          html += "</table>";
          document.getElementById('risultato').innerHTML = html;
        })
        .catch(err => {
          document.getElementById('risultato').innerText = "Errore nella richiesta: " + err;
        });
    }
  </script>
</body>
</html>
